_id: 4211033153
_parent: https://chester.me/archives/2017/12/voice-control-for-a-non-smart-tv-with-google-home-raspberry-pi-lirc-nginx-lua-ifttt/
replying_to_uid: ''
message: '<p>Hello! Many thanks for this post.<br>I try to implement it on my raspberry pi3 B+.</p><p>I make it step by step so I first try to implement nginx to receive http request instead of https.<br>So, in <i>/etc/nginx/sites-available/default</i> file, I add :</p><p></p><pre><code><br>server {<br>  listen 80;<br><br>  # HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)<br>  add_header Strict-Transport-Security max-age=15768000;<br><br>  error_page 500 502 503 504 /500.html;<br>  client_max_body_size 4G;<br>  keepalive_timeout 10;<br><br>  if ($request_method !~ ^(GET|HEAD|PUT|PATCH|POST|DELETE|OPTIONS)$ ){<br>    return 405;<br>  }<br>  <br>  location /remote {<br>    lua_need_request_body on;<br>    content_by_lua_block{<br>      local args, err = ngx.req.get_post_args()<br>      if not args then<br>        os.execute("echo noargs &gt; /home/pi/Desktop/lua_out");<br>      end<br>      if args["action"] == "action1"<br>      then<br>        os.execute("echo action1 &gt; /home/pi/Desktop/lua_out");<br>      end<br>    }<br>  }<br>}<br></code></pre><p></p><p>I restart nginx and try this configuration with this url directly inside chromium raspberry browser :<br><i>http://127.0.0.1/remote/</i></p><p>Unfortunately I never obtain a lua_out file on my Desktop...<br>I try with this configuration before with a file <i>/home/pi/Desktop/remote/index.html</i> that contain small hello world write in HTML and it was working, so I guess I have an error on lua script ?</p><p></p><pre><code><br>server {<br>listen 80;<br>listen [::]:80;<br><br>root /home/pi/Desktop/;<br><br>location /remote {<br>try_files $uri $uri/ =404;<br>}<br>}<br></code></pre><p></p><p>Can you help me a little please ? I''m deadlocked...</p>'
name: 'geo667'
email: 'a283b4bc6874e8c3394bed0bb26614d8'
hp: ''
date: 1543142161
            