_id: 4367989897
_parent: https://chester.me/archives/2017/12/voice-control-for-a-non-smart-tv-with-google-home-raspberry-pi-lirc-nginx-lua-ifttt/
replying_to_uid: ''
message: '<p>This tutorial is great!  I''ve got it also right, but for some reason I get a 404 return on the applet and when running curl --insecure action=tv_volume_up https://my.domain/remote (I''ve used a self-signed certificate so curl -d doesn''t like it).  I can access https://my.domain which gives me:</p><p>"If you see this page, the nginx web server is successfully installed and working. Further configuration is required.<br>For online documentation and support please refer to <a href="http://nginx.org" rel="nofollow noopener" title="nginx.org">nginx.org</a>.<br>Commercial support is available at <a href="http://nginx.com" rel="nofollow noopener" title="nginx.com">nginx.com</a>.<br>Thank you for using nginx."</p><p>My /etc/nginx/sites-enabled/my.domain contents are as follows:</p><p>Server {<br>  listen 80;<br>  listen 443 ssl;<br>  listen [::]:443 ssl;</p><p>  ssl_certificate /etc/ssl/certs/nginx-selfsigned.crt;<br>  ssl_certificate_key /etc/ssl/private/nginx-selfsigned.key;</p><p>  ssl_session_timeout 1d;<br>  ssl_session_cache shared:SSL:50m;<br>  ssl_session_tickets off;</p><p>  ssl_protocols TLSv1.1 TLSv1.2;<br>  ssl_ciphers ''EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH'';<br>  ssl_prefer_server_ciphers on;</p><p>  # HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)<br>  add_header Strict-Transport-Security max-age=15768000;</p><p>  # OCSP Stapling ---<br>  ssl_stapling on;<br>  ssl_stapling_verify on;</p><p>  error_page 500 502 503 504 /500.html;<br>  client_max_body_size 4G;<br>  keepalive_timeout 10;</p><p>  if ($request_method !~ ^(GET|HEAD|PUT|PATCH|POST|DELETE|OPTIONS)$ ){<br>    return 405;<br>  }<br>}<br>  ...</p><p>location /remote {<br>  lua_need_request_body on;<br>  content_by_lua_block {<br>    local args, err = ngx.req.get_post_args()<br>    if not args then<br>      return<br>    end<br>     if args["secret-key"] ~= "some_generated_secret" then<br>      return<br>    end<br>    if args["action"] == "tv_volume_up" then<br>      os.execute("irsend SEND_ONCE Samsung_BN59-01175N KEY_VOLUMEUP");<br>...<br>    elseif args["action"] == "tv_volume_down" then<br>      os.execute("irsend SEND_ONCE Samsung_BN59-01175N KEY_VOLUMEDOWN");<br>...<br>    end<br>  }<br>}</p><p>I''m really stuck as to what could be causing the 404 error.  Any ideas?</p><p>Thanks,</p><p>Dan</p>'
name: 'dantheman1988'
email: '25a78ea6c2a131bddaa2ab46486bbfb0'
hp: ''
date: 1551962044
            